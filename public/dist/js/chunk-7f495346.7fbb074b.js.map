{"version":3,"sources":["webpack:///./src/views/Article/Editor.vue?bfef","webpack:///./src/api/categories.js","webpack:///./src/views/Article/Editor.vue?3342","webpack:///src/views/Article/Editor.vue","webpack:///./src/views/Article/Editor.vue?5505","webpack:///./src/views/Article/Editor.vue","webpack:///./src/api/tags.js","webpack:///./src/api/articles.js"],"names":["createOne","params","request","post","updateOneWithId","id","patch","deleteOneWithId","delete","fetchList","get","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","model","value","form","callback","$$v","$set","expression","_l","item","key","name","ref","content","on","Object","assign","fileList","onUploadRemove","response","cover","handleSubmit","_v","staticRenderFns","data","title","html","text","categoryID","tagIdList","isPublished","categoryList","tagList","computed","action","currentId","$route","beforeRouteLeave","$refs","markdown","clearContent","next","methods","$message","error","created","component","deleteOne","updateOne","create","fetchOne","updateWithId","deleteWithId","deleteMany","idList","updatePublishStatus"],"mappings":"gHAAA,yBAAof,EAAG,G,oCCAvf,gBAEe,QACbA,UADa,SACHC,GACR,OAAOC,OAAQC,KAAK,cAAeF,IAErCG,gBAJa,SAIGC,EAAIJ,GAClB,OAAOC,OAAQI,MAAR,sBAA6BD,GAAMJ,IAE5CM,gBAPa,SAOGF,GACd,OAAOH,OAAQM,OAAR,sBAA8BH,KAEvCI,UAVa,WAWX,OAAOP,OAAQQ,IAAR,kB,2CCbX,IAAIC,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,UAAU,CAACG,MAAM,CAAC,cAAc,SAAS,CAACH,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,OAAO,SAAW,KAAK,CAACH,EAAG,YAAY,CAACG,MAAM,CAAC,UAAY,GAAG,YAAc,WAAWC,MAAM,CAACC,MAAOT,EAAIU,KAAe,WAAEC,SAAS,SAAUC,GAAMZ,EAAIa,KAAKb,EAAIU,KAAM,aAAcE,IAAME,WAAW,oBAAoBd,EAAIe,GAAIf,EAAgB,cAAE,SAASgB,GAAM,OAAOZ,EAAG,YAAY,CAACa,IAAID,EAAKvB,GAAGc,MAAM,CAAC,MAAQS,EAAKvB,GAAG,MAAQuB,EAAKE,WAAU,IAAI,GAAGd,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,OAAO,CAACH,EAAG,YAAY,CAACG,MAAM,CAAC,SAAW,GAAG,UAAY,GAAG,YAAc,WAAWC,MAAM,CAACC,MAAOT,EAAIU,KAAc,UAAEC,SAAS,SAAUC,GAAMZ,EAAIa,KAAKb,EAAIU,KAAM,YAAaE,IAAME,WAAW,mBAAmBd,EAAIe,GAAIf,EAAW,SAAE,SAASgB,GAAM,OAAOZ,EAAG,YAAY,CAACa,IAAID,EAAKvB,GAAGc,MAAM,CAAC,MAAQS,EAAKvB,GAAG,MAAQuB,EAAKE,WAAU,IAAI,GAAGd,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,OAAO,SAAW,KAAK,CAACH,EAAG,WAAW,CAACG,MAAM,CAAC,UAAY,IAAIC,MAAM,CAACC,MAAOT,EAAIU,KAAU,MAAEC,SAAS,SAAUC,GAAMZ,EAAIa,KAAKb,EAAIU,KAAM,QAASE,IAAME,WAAW,iBAAiB,GAAGV,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,OAAO,SAAW,KAAK,CAACH,EAAG,OAAO,CAACe,IAAI,WAAWZ,MAAM,CAAC,gBAAkBP,EAAIU,KAAKU,SAASC,GAAG,CAAC,OAAS,SAAUD,GAAU,OAAOE,OAAOC,OAAOvB,EAAIU,KAAKU,QAAQA,QAAgB,GAAGhB,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,QAAQ,CAACH,EAAG,SAAS,CAACG,MAAM,CAAC,YAAYP,EAAIwB,UAAUH,GAAG,CAAC,OAASrB,EAAIyB,eAAe,QAAU,SAAUC,GAAW,OAAOJ,OAAOC,OAAOvB,EAAIU,KAAKiB,MAAMD,QAAiB,GAAGtB,EAAG,eAAe,CAACG,MAAM,CAAC,MAAQ,SAAS,CAACH,EAAG,YAAY,CAACI,MAAM,CAACC,MAAOT,EAAIU,KAAgB,YAAEC,SAAS,SAAUC,GAAMZ,EAAIa,KAAKb,EAAIU,KAAM,cAAeE,IAAME,WAAW,uBAAuB,GAAGV,EAAG,eAAe,CAACA,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWc,GAAG,CAAC,MAAQrB,EAAI4B,eAAe,CAAC5B,EAAI6B,GAAG,SAAS,IAAI,IAAI,IAC31DC,EAAkB,G,0DCmDtB,GACEZ,KAAM,iBACNa,KAFF,WAGI,MAAO,CACLrB,KAAM,CACJsB,MAAO,GACPZ,QAAS,CACPa,KAAM,GACNC,KAAM,IAERP,MAAO,CAAf,iBACQQ,WAAY,GACZC,UAAW,GACXC,aAAa,GAGfC,aAAc,GACdC,QAAS,GACTf,SAAU,KAGdgB,SAAU,CACRC,OADJ,WAEM,OAAOxC,KAAKyC,UAAY,OAAS,UAEnCA,UAJJ,WAKM,OAAOzC,KAAK0C,OAAOtD,OAAOI,KAI9BmD,iBA9BF,SA8BA,OACI3C,KAAKS,KAAO,CACVsB,MAAO,GACPZ,QAAS,CACPa,KAAM,GACNC,KAAM,IAERP,MAAO,CAAb,iBACMQ,WAAY,GACZC,UAAW,GACXC,aAAa,GAEfpC,KAAKuB,SAAT,GACIvB,KAAK4C,MAAMC,SAASC,eACpBC,KAGFC,QAAS,CACPxB,eADJ,WAEMxB,KAAKS,KAAKiB,MAAQ,CAAxB,kBAEIC,aAJJ,WAIA,aAQA,UANA,EAFA,EAEA,YACA,EAHA,EAGA,UACA,EAJA,EAIA,WACA,EALA,EAKA,MACA,EANA,EAMA,QACA,EAPA,EAOA,MAGM,GAAKO,EAKL,GAAKH,EAKL,GAAKZ,EAAQa,KAAb,CAKA,IAAN,GACQD,MAAR,EACQZ,QAAR,EACQO,MAAR,EACQQ,WAAR,EACQC,UAAR,EACQC,YAAR,GAGA,EACA,uBACA,iBACA,sCAEMI,EACN,kBACA,oBACU,EAAV,2BAEU,EAAV,2BAGQ,EAAR,6BAEA,mBACQ,EAAR,kCA7BQxC,KAAKiD,SAASC,MAAM,gBALpBlD,KAAKiD,SAASC,MAAM,gBALpBlD,KAAKiD,SAASC,MAAM,aA6C1BC,QA3GF,WA2GA,WAEwB,SAAhBnD,KAAKwC,QACP,EAAN,8BACA,kBACQ,EAAR,wCAEA,cAGQ,EAAR,eACU,KAAV,aACU,IAAV,kBAGA,mBACQ,EAAR,6BAII,EAAJ,iBACA,kBACM,EAAN,kBAEA,mBACM,EAAN,6BAEI,EAAJ,iBACA,kBACM,EAAN,aAEA,mBACM,EAAN,+BC/L+V,I,wBCQ3VY,EAAY,eACd,EACAtD,EACA+B,GACA,EACA,KACA,WACA,MAIa,aAAAuB,E,2CCnBf,gBAEe,QACbjE,UADa,SACHC,GACR,OAAOC,OAAQC,KAAK,QAASF,IAE/BQ,UAJa,SAIHR,GACR,OAAOC,OAAQQ,IAAI,QAAS,CAAET,YAEhCiE,UAPa,SAOH7D,GACR,OAAOH,OAAQM,OAAR,gBAAwBH,KAEjC8D,UAVa,SAUH9D,EAAIJ,GACZ,OAAOC,OAAQI,MAAR,gBAAuBD,GAAMJ,M,kCCbxC,gBAEe,QACbmE,OADa,SACNnE,GACL,OAAOC,OAAQC,KAAK,YAAaF,IAEnCQ,UAJa,SAIHR,GACR,OAAOC,OAAQQ,IAAI,YAAa,CAAET,YAEpCoE,SAPa,SAOJhE,GACP,OAAOH,OAAQQ,IAAR,oBAAyBL,KAElCiE,aAVa,SAUAjE,EAAIJ,GACf,OAAOC,OAAQI,MAAR,oBAA2BD,GAAMJ,IAE1CsE,aAba,SAaAlE,GACX,OAAOH,OAAQM,OAAR,oBAA4BH,KAErCmE,WAhBa,SAgBFC,GACT,OAAOvE,OAAQM,OAAO,YAAa,CAAEP,OAAQ,CAAEwE,aAEjDC,oBAnBa,SAmBOrE,EAAIJ,GACtB,OAAOC,OAAQI,MAAR,oBAA2BD,EAA3B,WAAwCJ,M","file":"js/chunk-7f495346.7fbb074b.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&id=8fa038de&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&id=8fa038de&lang=less&scoped=true&\"","import request from './request'\n\nexport default {\n  createOne(params) {\n    return request.post('/categories', params)\n  },\n  updateOneWithId(id, params) {\n    return request.patch(`/categories/${id}`, params)\n  },\n  deleteOneWithId(id) {\n    return request.delete(`/categories/${id}`)\n  },\n  fetchList() {\n    return request.get(`/categories`)\n  },\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"editor-wrapper\"},[_c('el-form',{attrs:{\"label-width\":\"auto\"}},[_c('el-form-item',{attrs:{\"label\":\"文章分类\",\"required\":\"\"}},[_c('el-select',{attrs:{\"clearable\":\"\",\"placeholder\":\"请选择文章分类\"},model:{value:(_vm.form.categoryID),callback:function ($$v) {_vm.$set(_vm.form, \"categoryID\", $$v)},expression:\"form.categoryID\"}},_vm._l((_vm.categoryList),function(item){return _c('el-option',{key:item.id,attrs:{\"value\":item.id,\"label\":item.name}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"标签\"}},[_c('el-select',{attrs:{\"multiple\":\"\",\"clearable\":\"\",\"placeholder\":\"请添加文章标签\"},model:{value:(_vm.form.tagIdList),callback:function ($$v) {_vm.$set(_vm.form, \"tagIdList\", $$v)},expression:\"form.tagIdList\"}},_vm._l((_vm.tagList),function(item){return _c('el-option',{key:item.id,attrs:{\"value\":item.id,\"label\":item.name}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"文章标题\",\"required\":\"\"}},[_c('el-input',{attrs:{\"clearable\":\"\"},model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"文章内容\",\"required\":\"\"}},[_c('pell',{ref:\"markdown\",attrs:{\"initialMarkdown\":_vm.form.content},on:{\"change\":function (content){ return Object.assign(_vm.form.content,content); }}})],1),_c('el-form-item',{attrs:{\"label\":\"缩略图\"}},[_c('upload',{attrs:{\"file-list\":_vm.fileList},on:{\"remove\":_vm.onUploadRemove,\"success\":function (response){ return Object.assign(_vm.form.cover,response); }}})],1),_c('el-form-item',{attrs:{\"label\":\"是否发布\"}},[_c('el-switch',{model:{value:(_vm.form.isPublished),callback:function ($$v) {_vm.$set(_vm.form, \"isPublished\", $$v)},expression:\"form.isPublished\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleSubmit}},[_vm._v(\"确定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"editor-wrapper\">\n    <el-form label-width=\"auto\">\n      <el-form-item label=\"文章分类\" required>\n        <el-select clearable placeholder=\"请选择文章分类\" v-model=\"form.categoryID\">\n          <el-option\n            :value=\"item.id\"\n            :label=\"item.name\"\n            v-for=\"item in categoryList\"\n            :key=\"item.id\"\n          ></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"标签\">\n        <el-select multiple clearable placeholder=\"请添加文章标签\" v-model=\"form.tagIdList\">\n          <el-option :value=\"item.id\" :label=\"item.name\" v-for=\"item in tagList\" :key=\"item.id\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"文章标题\" required>\n        <el-input v-model=\"form.title\" clearable></el-input>\n      </el-form-item>\n      <el-form-item label=\"文章内容\" required>\n        <pell\n          ref=\"markdown\"\n          @change=\"content=>Object.assign(form.content,content)\"\n          :initialMarkdown=\"form.content\"\n        ></pell>\n      </el-form-item>\n\n      <el-form-item label=\"缩略图\">\n        <upload\n          @remove=\"onUploadRemove\"\n          @success=\"response=>Object.assign(form.cover,response)\"\n          :file-list=\"fileList\"\n        ></upload>\n      </el-form-item>\n      <el-form-item label=\"是否发布\">\n        <el-switch v-model=\"form.isPublished\"></el-switch>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"handleSubmit\">确定</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport ArticleApi from '@/api/articles'\nimport CategoryApi from '@/api/categories'\nimport TagApi from '@/api/tags'\n \n\nexport default {\n  name: 'article-editor',\n  data() {\n    return {\n      form: {\n        title: '',\n        content: {\n          html: '',\n          text: ''\n        },\n        cover: { name: '', path: '' },\n        categoryID: '',\n        tagIdList: [],\n        isPublished: false\n      },\n\n      categoryList: [],\n      tagList: [],\n      fileList: []\n    }\n  },\n  computed: {\n    action() {\n      return this.currentId ? 'edit' : 'create'\n    },\n    currentId() {\n      return this.$route.params.id\n    }\n  },\n\n  beforeRouteLeave(from, to, next) {\n    this.form = {\n      title: '',\n      content: {\n        html: '',\n        text: ''\n      },\n      cover: { name: '', path: '' },\n      categoryID: '',\n      tagIdList: [],\n      isPublished: false\n    }\n    this.fileList=[]\n    this.$refs.markdown.clearContent()\n    next()\n  },\n\n  methods: {\n    onUploadRemove() {\n      this.form.cover = { name: '', path: '' }\n    },\n    handleSubmit() {\n      const {\n        isPublished,\n        tagIdList,\n        categoryID,\n        title,\n        content,\n        cover\n      } = this.form\n\n      if (!categoryID) {\n        this.$message.error('请选择文章分类')\n        return\n      }\n\n      if (!title) {\n        this.$message.error('请输入文章标题')\n        return\n      }\n\n      if (!content.html) {\n        this.$message.error('请输入文章内容')\n        return\n      }\n\n      const payload = {\n        title,\n        content,\n        cover,\n        categoryID,\n        tagIdList,\n        isPublished\n      }\n\n      const action =\n        this.action === 'create'\n          ? ArticleApi.create(payload)\n          : ArticleApi.updateWithId(this.currentId, payload)\n\n      action\n        .then(data => {\n          if (this.action === 'create') {\n            this.$message.success('添加文章成功')\n          } else {\n            this.$message.success('更新文章成功')\n          }\n\n          this.$router.push('/articles')\n        })\n        .catch(err => {\n          this.$message.error(err.message)\n        })\n    },\n     \n  },\n\n  created() {\n    \n    if (this.action === 'edit') {\n      ArticleApi.fetchOne(this.currentId)\n        .then(response => {\n          _.assign(this.form, _.pick(response, _.keys(this.form)))\n\n          if (!response.cover.path) {\n            return\n          }\n          this.fileList.push({\n            name: response.cover.name,\n            url: response.cover.path\n          })\n        })\n        .catch(err => {\n          this.$message.error(err.message)\n        })\n    \n    } \n    CategoryApi.fetchList()\n      .then(response => {\n        this.categoryList = response\n      })\n      .catch(err => {\n        this.$message.error(err.message)\n      })\n    TagApi.fetchList()\n      .then(response => {\n        this.tagList = response\n      })\n      .catch(err => {\n        this.$message.error(err.message)\n      })\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.editor-wrapper {\n  width: 700px;\n}\n/deep/.el-select {\n  width: 100%;\n}\n</style>\n\n ","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Editor.vue?vue&type=template&id=8fa038de&scoped=true&\"\nimport script from \"./Editor.vue?vue&type=script&lang=js&\"\nexport * from \"./Editor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Editor.vue?vue&type=style&index=0&id=8fa038de&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8fa038de\",\n  null\n  \n)\n\nexport default component.exports","import request from './request'\n\nexport default {\n  createOne(params) {\n    return request.post('/tags', params)\n  },\n  fetchList(params) {\n    return request.get('/tags', { params })\n  },\n  deleteOne(id) {\n    return request.delete(`/tags/${id}`)\n  },\n  updateOne(id, params) {\n    return request.patch(`/tags/${id}`, params)\n  },\n}\n","import request from './request'\n\nexport default {\n  create(params) {\n    return request.post('/articles', params)\n  },\n  fetchList(params) {\n    return request.get('/articles', { params })\n  },\n  fetchOne(id) {\n    return request.get(`/articles/${id}`)\n  },\n  updateWithId(id, params) {\n    return request.patch(`/articles/${id}`, params)\n  },\n  deleteWithId(id) {\n    return request.delete(`/articles/${id}`)\n  },\n  deleteMany(idList) {\n    return request.delete('/articles', { params: { idList } })\n  },\n  updatePublishStatus(id, params) {\n    return request.patch(`/articles/${id}/status`, params)\n  },\n}\n"],"sourceRoot":""}