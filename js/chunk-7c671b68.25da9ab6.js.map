{"version":3,"sources":["webpack:///./src/views/Tag/index.vue?a3c5","webpack:///src/views/Tag/index.vue","webpack:///./src/views/Tag/index.vue?c6af","webpack:///./src/views/Tag/index.vue","webpack:///./src/api/tags.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","on","toggleTab","model","value","callback","$$v","activeName","expression","attrs","dataList","scopedSlots","_u","key","fn","ref","row","staticStyle","cover","path","_v","_s","Date","updatedAt","toLocaleTimeString","createdAt","$index","$event","editOne","id","deleteOne","tagAction","form","$set","fileList","name","response","Object","assign","handleSubmit","staticRenderFns","data","action","computed","watch","setTimeout","$refs","input","focus","created","methods","$message","warning","resetTab","activeInstance","editingItem","_","pick","component","createOne","params","request","post","fetchList","get","delete","updateOne","patch"],"mappings":"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","file":"js/chunk-7c671b68.25da9ab6.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{},[_c('el-tabs',{on:{\"tab-click\":_vm.toggleTab},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"name\":\"list\",\"label\":\"标签列表\"}},[_c('el-table',{attrs:{\"data\":_vm.dataList,\"border\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"名称\"}}),_c('el-table-column',{attrs:{\"label\":\"封面\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('el-image',{staticStyle:{\"height\":\"60px\"},attrs:{\"src\":row.cover.path,\"preview-src-list\":[row.cover.path],\"fit\":\"cover\"}})]}}])}),_c('el-table-column',{attrs:{\"prop\":\"articleCount\",\"label\":\"文章数量\"}}),_c('el-table-column',{attrs:{\"prop\":\"articlePublishedCount\",\"label\":\"已发布文章数量\"}}),_c('el-table-column',{attrs:{\"label\":\"更新时间\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_vm._v(_vm._s(new Date(row.updatedAt).toLocaleTimeString()))]}}])}),_c('el-table-column',{attrs:{\"label\":\"创建时间\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_vm._v(_vm._s(new Date(row.createdAt).toLocaleTimeString()))]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nvar $index = ref.$index;\nreturn [_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.editOne(row.id,row)}}},[_vm._v(\"编辑\")]),_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.deleteOne(row.id,$index)}}},[_vm._v(\"删除\")])]}}])})],1)],1),_c('el-tab-pane',{attrs:{\"name\":\"action\",\"label\":_vm.tagAction}},[_c('el-form',[_c('el-form-item',{attrs:{\"label\":\"名称\"}},[_c('el-input',{ref:\"input\",model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"封面\"}},[_c('upload',{attrs:{\"file-list\":_vm.fileList},on:{\"remove\":function($event){_vm.form.cover={path:'',name:''}},\"success\":function (response){ return Object.assign(_vm.form.cover,response); }}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleSubmit}},[_vm._v(\"确定\")])],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class>\n    <el-tabs @tab-click=\"toggleTab\" v-model=\"activeName\">\n      <el-tab-pane name=\"list\" label=\"标签列表\">\n        <el-table :data=\"dataList\" border>\n          <el-table-column prop=\"name\" label=\"名称\"></el-table-column>\n          <el-table-column label=\"封面\">\n            <template v-slot=\"{row}\">\n              <el-image :src=\"row.cover.path\" style=\"height:60px\" :preview-src-list=\"[row.cover.path]\" fit=\"cover\"></el-image>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"articleCount\" label=\"文章数量\"></el-table-column>\n          <el-table-column prop=\"articlePublishedCount\" label=\"已发布文章数量\"></el-table-column>\n          <el-table-column label=\"更新时间\">\n            <template v-slot=\"{row}\">{{new Date(row.updatedAt).toLocaleTimeString()}}</template>\n          </el-table-column>\n          <el-table-column label=\"创建时间\">\n            <template v-slot=\"{row}\">{{new Date(row.createdAt).toLocaleTimeString()}}</template>\n          </el-table-column>\n          <el-table-column label=\"操作\">\n            <template v-slot=\"{row,$index}\">\n              <el-button type=\"primary\" @click=\"editOne(row.id,row)\" size=\"small\">编辑</el-button>\n              <el-button type=\"danger\" @click=\"deleteOne(row.id,$index)\" size=\"small\">删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-tab-pane>\n      <el-tab-pane name=\"action\" :label=\"tagAction\">\n        <el-form>\n          <el-form-item label=\"名称\">\n            <el-input ref=\"input\" v-model=\"form.name\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"封面\">\n            <upload\n              :file-list=\"fileList\"\n              @remove=\"form.cover={path:'',name:''} \"\n              @success=\"response=>Object.assign(form.cover,response)\"\n            ></upload>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"handleSubmit\">确定</el-button>\n          </el-form-item>\n        </el-form>\n      </el-tab-pane>\n    </el-tabs>\n  </div>\n</template>\n\n<script>\nimport TagApi from '@/api/tags'\nexport default {\n  name: 'Tag',\n  data() {\n    return {\n      dataList: [],\n      fileList: [],\n      activeName: 'list',\n      action: 'create',\n      form: {\n        name: '',\n        cover: { path: '', name: '' }\n      }\n    }\n  },\n  computed: {\n    tagAction() {\n      return this.action === 'edit' ? '编辑标签' : '添加标签'\n    }\n  },\n  watch: {\n    activeName() {\n      setTimeout(this.$refs.input.focus)\n    }\n  },\n  created() {\n    TagApi.fetchList()\n      .then(response => {\n        this.dataList = response\n      })\n      .catch(err => this.$message.error(err.message))\n  },\n  methods: {\n    handleSubmit() {\n      const { name, cover } = this.form\n      if (!name) {\n        this.$message.warning('请输入标签名称')\n        return\n      }\n\n      if (!cover.path) {\n        this.$message.warning('请上传图片')\n        return\n      }\n\n      const payload = { name, cover }\n\n      const action =\n        this.action === 'edit'\n          ? TagApi.updateOne(this.editingItem.id, payload)\n          : TagApi.createOne(payload)\n\n      action\n        .then(response => {\n          if (this.action === 'edit') {\n            this.editingItem.name = name\n            this.$message.success('标签编辑成功')\n          } else {\n            this.$message.success('标签添加成功')\n            this.dataList.unshift(response)\n          }\n          this.resetTab()\n        })\n        .catch(err => this.$message.error(err.message))\n    },\n    resetTab() {\n      this.activeName = 'list'\n      this.action = 'create'\n      this.form.name = ''\n      this.form.cover = { name: '', path: '' }\n      this.fileList = []\n    },\n    toggleTab(activeInstance) {\n      if (activeInstance.name === 'list') {\n        this.resetTab()\n      }\n    },\n    async deleteOne(id, index) {\n      try {\n        await this.$confirm('此标签以经删除将无法恢复, 是否继续 ?', '提示', {\n          type: 'warning'\n        })\n      } catch (err) {\n        return\n      }\n\n      TagApi.deleteOne(id)\n        .then(() => {\n          this.$message.success('删除成功')\n          this.dataList.splice(index, 1)\n        })\n        .catch(err => this.$message.error(err.message))\n    },\n    editOne(id, row) {\n      this.editingItem = row\n      this.activeName = 'action'\n      this.action = 'edit'\n      _.assign(this.form, _.pick(row, ['name', 'cover']))\n      const { path, name } = this.form.cover\n      if (path) {\n        this.fileList = [{ url: path, name }]\n      }\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1333d850&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import request from './request'\n\nexport default {\n  createOne(params) {\n    return request.post('/tags', params)\n  },\n  fetchList(params) {\n    return request.get('/tags', { params })\n  },\n  deleteOne(id) {\n    return request.delete(`/tags/${id}`)\n  },\n  updateOne(id, params) {\n    return request.patch(`/tags/${id}`, params)\n  },\n}\n"],"sourceRoot":""}