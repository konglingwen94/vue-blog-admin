(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f495346"],{5329:function(t,e,a){"use strict";var r=a("8a4f"),n=a.n(r);n.a},"66da":function(t,e,a){"use strict";var r=a("0c6d");e["a"]={createOne:function(t){return r["a"].post("/categories",t)},updateOneWithId:function(t,e){return r["a"].patch("/categories/".concat(t),e)},deleteOneWithId:function(t){return r["a"].delete("/categories/".concat(t))},fetchList:function(){return r["a"].get("/categories")}}},"7c99":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editor-wrapper"},[a("el-form",{attrs:{"label-width":"auto"}},[a("el-form-item",{attrs:{label:"文章分类",required:""}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择文章分类"},model:{value:t.form.categoryID,callback:function(e){t.$set(t.form,"categoryID",e)},expression:"form.categoryID"}},t._l(t.categoryList,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1),a("el-form-item",{attrs:{label:"标签"}},[a("el-select",{attrs:{multiple:"",clearable:"",placeholder:"请添加文章标签"},model:{value:t.form.tagIdList,callback:function(e){t.$set(t.form,"tagIdList",e)},expression:"form.tagIdList"}},t._l(t.tagList,(function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})})),1)],1),a("el-form-item",{attrs:{label:"文章标题",required:""}},[a("el-input",{attrs:{clearable:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"文章内容",required:""}},[a("pell",{ref:"markdown",attrs:{initialMarkdown:t.form.content},on:{change:function(e){return Object.assign(t.form.content,e)}}})],1),a("el-form-item",{attrs:{label:"缩略图"}},[a("upload",{attrs:{"file-list":t.fileList},on:{remove:t.onUploadRemove,success:function(e){return Object.assign(t.form.cover,e)}}})],1),a("el-form-item",{attrs:{label:"是否发布"}},[a("el-switch",{model:{value:t.form.isPublished,callback:function(e){t.$set(t.form,"isPublished",e)},expression:"form.isPublished"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确定")])],1)],1)],1)},n=[],i=(a("7f7f"),a("ac6a"),a("8691")),c=a("66da"),s=a("8020"),o={name:"article-editor",data:function(){return{form:{title:"",content:{html:"",text:""},cover:{name:"",path:""},categoryID:"",tagIdList:[],isPublished:!1},categoryList:[],tagList:[],fileList:[]}},computed:{action:function(){return this.currentId?"edit":"create"},currentId:function(){return this.$route.params.id}},beforeRouteLeave:function(t,e,a){this.form={title:"",content:{html:"",text:""},cover:{name:"",path:""},categoryID:"",tagIdList:[],isPublished:!1},this.fileList=[],this.$refs.markdown.clearContent(),a()},methods:{onUploadRemove:function(){this.form.cover={name:"",path:""}},handleSubmit:function(){var t=this,e=this.form,a=e.isPublished,r=e.tagIdList,n=e.categoryID,c=e.title,s=e.content,o=e.cover;if(n)if(c)if(s.html){var l={title:c,content:s,cover:o,categoryID:n,tagIdList:r,isPublished:a},u="create"===this.action?i["a"].create(l):i["a"].updateWithId(this.currentId,l);u.then((function(e){"create"===t.action?t.$message.success("添加文章成功"):t.$message.success("更新文章成功"),t.$router.push("/articles")})).catch((function(e){t.$message.error(e.message)}))}else this.$message.error("请输入文章内容");else this.$message.error("请输入文章标题");else this.$message.error("请选择文章分类")}},created:function(){var t=this;"edit"===this.action&&i["a"].fetchOne(this.currentId).then((function(e){_.assign(t.form,_.pick(e,_.keys(t.form))),e.cover.path&&t.fileList.push({name:e.cover.name,url:e.cover.path})})).catch((function(e){t.$message.error(e.message)})),c["a"].fetchList().then((function(e){t.categoryList=e})).catch((function(e){t.$message.error(e.message)})),s["a"].fetchList().then((function(e){t.tagList=e})).catch((function(e){t.$message.error(e.message)}))}},l=o,u=(a("5329"),a("2877")),f=Object(u["a"])(l,r,n,!1,null,"8fa038de",null);e["default"]=f.exports},8020:function(t,e,a){"use strict";var r=a("0c6d");e["a"]={createOne:function(t){return r["a"].post("/tags",t)},fetchList:function(t){return r["a"].get("/tags",{params:t})},deleteOne:function(t){return r["a"].delete("/tags/".concat(t))},updateOne:function(t,e){return r["a"].patch("/tags/".concat(t),e)}}},8691:function(t,e,a){"use strict";var r=a("0c6d");e["a"]={create:function(t){return r["a"].post("/articles",t)},fetchList:function(t){return r["a"].get("/articles",{params:t})},fetchOne:function(t){return r["a"].get("/articles/".concat(t))},updateWithId:function(t,e){return r["a"].patch("/articles/".concat(t),e)},deleteWithId:function(t){return r["a"].delete("/articles/".concat(t))},deleteMany:function(t){return r["a"].delete("/articles",{params:{idList:t}})},updatePublishStatus:function(t,e){return r["a"].patch("/articles/".concat(t,"/status"),e)}}},"8a4f":function(t,e,a){}}]);
//# sourceMappingURL=chunk-7f495346.eb8a95ec.js.map