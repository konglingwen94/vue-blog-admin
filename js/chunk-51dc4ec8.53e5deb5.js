(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51dc4ec8"],{"0a49":function(e,t,n){var r=n("9b43"),a=n("626a"),s=n("4bf8"),c=n("9def"),i=n("cd1c");e.exports=function(e,t){var n=1==e,o=2==e,u=3==e,l=4==e,d=6==e,f=5==e||d,p=t||i;return function(t,i,m){for(var h,v,b=s(t),g=a(b),y=r(i,m,3),w=c(g.length),_=0,x=n?p(t,w):o?p(t,0):void 0;w>_;_++)if((f||_ in g)&&(h=g[_],v=y(h,_,b),e))if(n)x[_]=v;else if(v)switch(e){case 3:return!0;case 5:return h;case 6:return _;case 2:x.push(h)}else if(l)return!1;return d?-1:u||l?l:x}}},1169:function(e,t,n){var r=n("2d95");e.exports=Array.isArray||function(e){return"Array"==r(e)}},"20d6":function(e,t,n){"use strict";var r=n("5ca1"),a=n("0a49")(6),s="findIndex",c=!0;s in[]&&Array(1)[s]((function(){c=!1})),r(r.P+r.F*c,"Array",{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(s)},"4c4d":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("Panel",[n("el-button",{attrs:{slot:"header",type:"danger"},on:{click:e.deleteMany},slot:"header"},[e._v("批量删除")]),n("el-table",{attrs:{data:e.dataList,border:""},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection"}}),n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-row",{attrs:{gutter:40,type:"flex",justify:"space-between"}},[n("el-col",[n("el-card",{attrs:{header:r.title}},[n("div",{staticClass:"article-content"},[e._v(e._s(r.content.text))]),n("el-image",{staticStyle:{height:"100px",width:"100px"},attrs:{src:r.cover&&r.cover.path,fit:"cover"}},[n("div",{attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline"})])])],1)],1),n("el-col",[n("el-card",[n("div",{staticClass:"comments-card-header",attrs:{slot:"header"},slot:"header"},[n("div",[e._v("文章评论")]),n("div",{},[e.selectedCommentList.length?n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.removeComments(r.comments)}}},[e._v("删除选中评论")]):e._e()],1)]),n("el-checkbox-group",{model:{value:e.selectedCommentList,callback:function(t){e.selectedCommentList=t},expression:"selectedCommentList"}},[n("el-timeline",e._l(r.comments,(function(t){return n("el-timeline-item",{key:t.id,attrs:{placement:"top",timestamp:new Date(t.createdAt).toLocaleString()}},[n("div",{attrs:{slot:"dot"},slot:"dot"},[n("el-checkbox",{attrs:{label:t.id}},[e._v(e._s(""))])],1),n("div",{staticClass:"nickname"},[e._v(e._s(t.nickname))]),n("div",{staticClass:"content"},[e._v(e._s(t.content))])])})),1)],1)],1)],1)],1)]}}])}),n("el-table-column",{attrs:{label:"所属类别","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(e._s(n.category&&n.category.name))]}}])}),n("el-table-column",{attrs:{label:"标签","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[Array.isArray(r.tagList)?n("span",[e._v(e._s(r.tagList.map((function(e){return e&&e.name})).join(" , ")))]):e._e()]}}])}),n("el-table-column",{attrs:{label:"标题","show-overflow-tooltip":"",prop:"title"}}),n("el-table-column",{attrs:{label:"评论数量",prop:"commentCount"}}),n("el-table-column",{attrs:{prop:"pv",label:"浏览量(次)"}}),n("el-table-column",{attrs:{prop:"starCount",label:"星星个数"}}),n("el-table-column",{attrs:{prop:"pv",label:"是否发布"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("span",{style:{color:r.isPublished?"rgb(58, 136, 20)":"#E6A23C"}},[e._v(e._s(r.isPublished?"已发布":"未发布"))])]}}])}),n("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(e._s(new Date(n.createdAt).toLocaleString()))]}}])}),n("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"190px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row,a=t.$index;return[n("p",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.updateOne(r)}}},[e._v("更新")]),n("el-button",{attrs:{type:r.isPublished?"warning":"success",size:"small"},on:{click:function(t){return e.togglePublishStatus(r)}}},[e._v(e._s(r.isPublished?"下线":"发布"))]),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.deleteOne(r.id,a)}}},[e._v("删除")])],1)]}}])})],1)],1)],1)},a=[],s=(n("20d6"),n("ac6a"),n("96cf"),n("3b8d")),c=n("8691"),i=n("8b8c"),o={data:function(){return{dataList:[],selectedCommentList:[],selection:[]}},created:function(){var e=this;c["a"].fetchList().then((function(t){e.dataList=t})).catch((function(t){console.error(t);try{e.$message.error(t.message)}catch(t){}}))},methods:{removeComments:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("此数据以经删除将无法恢复，是否删除？","提示",{type:"warning"});case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e["catch"](0),e.abrupt("return");case 8:n=this.selectedCommentList,i["a"].deleteList({idList:n}).then((function(){r.selectedCommentList=[],r.$message.success("共删除".concat(n.length,"条评论")),n.forEach((function(e){var n=t.findIndex((function(t){return e===t.id}));t.splice(n,1)}))})).catch((function(e){r.$message.error(e.message)}));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t){return e.apply(this,arguments)}return t}(),deleteMany:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.selection.map((function(e){return e.id})),t.length){e.next=4;break}return this.$message.info("请选择您要删除的选项"),e.abrupt("return");case 4:return e.prev=4,e.next=7,this.$confirm("您选择的文章以经删除将无法恢复,是否确定 ?","提示",{type:"warning"});case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e["catch"](4),e.abrupt("return");case 12:c["a"].deleteMany(t).then((function(){n.selection.forEach((function(e){var t=n.dataList.indexOf(e);t>-1&&n.dataList.splice(t,1)})),n.$message.success("".concat(t.length,"篇文章删除成功"))})).catch((function(e){n.$message.error(e.message)}));case 13:case"end":return e.stop()}}),e,this,[[4,9]])})));function t(){return e.apply(this,arguments)}return t}(),handleSelectionChange:function(e){this.selection=e},togglePublishStatus:function(e){var t=this;c["a"].updatePublishStatus(e.id,{isPublished:!e.isPublished}).then((function(){t.$message.success(e.isPublished?"下线文章成功":"发布文章成功"),e.isPublished=!e.isPublished})).catch((function(e){t.$message.error(e.message)}))},addOne:function(){this.$router.push("/articles/new")},updateOne:function(e){var t=e.id;this.$router.push({name:"ArticleEditor",params:{id:t}})},deleteOne:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("您确定要删除此文章吗?","提示",{type:"warning"});case 3:e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return");case 9:c["a"].deleteWithId(t).then((function(){r.dataList.splice(n,1),r.$message.success("文章删除成功")})).catch((function(e){r.$message.error(e.message)}));case 10:case"end":return e.stop()}}),e,this,[[0,6]])})));function t(t,n){return e.apply(this,arguments)}return t}()}},u=o,l=(n("5fe6"),n("2877")),d=Object(l["a"])(u,r,a,!1,null,"27503b06",null);t["default"]=d.exports},"5fe6":function(e,t,n){"use strict";var r=n("cbb5a"),a=n.n(r);a.a},8691:function(e,t,n){"use strict";var r=n("0c6d");t["a"]={create:function(e){return r["a"].post("/articles",e)},fetchList:function(e){return r["a"].get("/articles",{params:e})},fetchOne:function(e){return r["a"].get("/articles/".concat(e))},updateWithId:function(e,t){return r["a"].patch("/articles/".concat(e),t)},deleteWithId:function(e){return r["a"].delete("/articles/".concat(e))},deleteMany:function(e){return r["a"].delete("/articles",{params:{idList:e}})},updatePublishStatus:function(e,t){return r["a"].patch("/articles/".concat(e,"/status"),t)}}},"8b8c":function(e,t,n){"use strict";var r=n("0c6d");t["a"]={fetchArticleCommentList:function(e){return r["a"].get("/articles/".concat(e,"/comments"))},fetchAllCommentList:function(){return r["a"].get("/comments")},deleteOne:function(e){return r["a"].delete("/comments/".concat(e))},deleteMany:function(e){return r["a"].delete("/comments",{params:e})}}},cbb5a:function(e,t,n){},cd1c:function(e,t,n){var r=n("e853");e.exports=function(e,t){return new(r(e))(t)}},e853:function(e,t,n){var r=n("d3f4"),a=n("1169"),s=n("2b4c")("species");e.exports=function(e){var t;return a(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!a(t.prototype)||(t=void 0),r(t)&&(t=t[s],null===t&&(t=void 0))),void 0===t?Array:t}}}]);
//# sourceMappingURL=chunk-51dc4ec8.53e5deb5.js.map