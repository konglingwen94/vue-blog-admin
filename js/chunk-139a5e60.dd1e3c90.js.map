{"version":3,"sources":["webpack:///./src/api/categories.js","webpack:///./src/views/Category/List.vue?1b86","webpack:///src/views/Category/List.vue","webpack:///./src/views/Category/List.vue?b7fb","webpack:///./src/views/Category/List.vue"],"names":["createOne","params","request","post","updateOneWithId","id","patch","deleteOneWithId","delete","fetchList","get","render","_vm","this","_h","$createElement","_c","_self","attrs","slot","on","handleAdd","_v","dataList","scopedSlots","_u","key","fn","ref","row","staticStyle","cover","path","_s","Date","createdAt","toLocaleString","$index","$event","editOne","deleteOne","dialogVisible","dialogTitle","onDialogOpen","closeDialog","model","value","form","callback","$$v","$set","expression","fileList","name","response","Object","assign","handleSubmit","staticRenderFns","data","action","created","computed","methods","$refs","input","focus","openDialog","resetDialog","editingItem","item","_","merge","pick","keys","$message","error","component"],"mappings":"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","file":"js/chunk-139a5e60.dd1e3c90.js","sourcesContent":["import request from './request'\n\nexport default {\n  createOne(params) {\n    return request.post('/categories', params)\n  },\n  updateOneWithId(id, params) {\n    return request.patch(`/categories/${id}`, params)\n  },\n  deleteOneWithId(id) {\n    return request.delete(`/categories/${id}`)\n  },\n  fetchList() {\n    return request.get(`/categories`)\n  },\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('panel',[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleAdd}},[_vm._v(\"添加文章分类\")])],1),_c('el-table',{attrs:{\"data\":_vm.dataList,\"border\":\"\"}},[_c('el-table-column',{attrs:{\"label\":\"分类名称\",\"prop\":\"name\"}}),_c('el-table-column',{attrs:{\"label\":\"封面\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('el-image',{staticStyle:{\"width\":\"80px\",\"height\":\"80px\"},attrs:{\"src\":row.cover.path,\"fit\":\"cover\",\"preview-src-list\":[row.cover.path]}})]}}])}),_c('el-table-column',{attrs:{\"label\":\"文章数量\",\"prop\":\"articleCount\"}}),_c('el-table-column',{attrs:{\"label\":\"已发布文章数量\",\"prop\":\"articlePublishedCount\"}}),_c('el-table-column',{attrs:{\"label\":\"创建时间\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_vm._v(_vm._s(new Date(row.createdAt).toLocaleString()))]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nvar $index = ref.$index;\nreturn [_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.editOne(row)}}},[_vm._v(\"编辑\")]),_c('el-button',{attrs:{\"type\":\"danger\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.deleteOne(row.id,$index)}}},[_vm._v(\"删除\")])]}}])})],1),_c('el-dialog',{attrs:{\"visible\":_vm.dialogVisible,\"title\":_vm.dialogTitle},on:{\"opened\":_vm.onDialogOpen,\"close\":_vm.closeDialog}},[_c('el-form',{attrs:{\"label-width\":\"auto\"}},[_c('el-form-item',{attrs:{\"label\":\"分类名称\"}},[_c('el-input',{ref:\"input\",attrs:{\"clearable\":\"\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"分类封面\"}},[_c('upload',{attrs:{\"file-list\":_vm.fileList},on:{\"remove\":function($event){_vm.form.cover={name:'',path:''}},\"success\":function (response){ return Object.assign(_vm.form.cover,response); }}})],1)],1),_c('el-button',{attrs:{\"slot\":\"footer\"},on:{\"click\":_vm.handleSubmit},slot:\"footer\"},[_vm._v(\"确定\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <panel>\n    <div slot=\"header\">\n      <el-button @click=\"handleAdd\" type=\"primary\">添加文章分类</el-button>\n    </div>\n\n    <el-table :data=\"dataList\" border>\n      <el-table-column label=\"分类名称\" prop=\"name\"></el-table-column>\n      <el-table-column label=\"封面\"  >\n        <template v-slot=\"{row}\">\n\n        <el-image :src=\"row.cover.path\" style=\"width:80px;height:80px\" fit=\"cover\" :preview-src-list=\"[row.cover.path]\"></el-image>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"文章数量\" prop=\"articleCount\"></el-table-column>\n      <el-table-column label=\"已发布文章数量\" prop=\"articlePublishedCount\"></el-table-column>\n      <el-table-column label=\"创建时间\">\n        <template v-slot=\"{row}\">{{new Date(row.createdAt).toLocaleString()}}</template>\n      </el-table-column>\n      <el-table-column label=\"操作\">\n        <template v-slot=\"{row,$index}\">\n          <el-button @click=\"editOne(row)\" type=\"primary\" size=\"small\">编辑</el-button>\n          <el-button @click=\"deleteOne(row.id,$index)\" type=\"danger\" size=\"small\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <el-dialog\n      @opened=\"onDialogOpen\"\n      :visible=\"dialogVisible\"\n      @close=\"closeDialog\"\n      :title=\"dialogTitle\"\n    >\n      <el-form label-width=\"auto\">\n        <el-form-item label=\"分类名称\">\n          <el-input ref=\"input\" v-model=\"form.name\" clearable></el-input>\n        </el-form-item>\n        <el-form-item label=\"分类封面\">\n          <upload\n            @remove=\"form.cover={name:'',path:''}\"\n            @success=\"response=>Object.assign(form.cover,response)\"\n            :file-list=\"fileList\"\n          ></upload>\n        </el-form-item>\n      </el-form>\n      <el-button slot=\"footer\" @click=\"handleSubmit\">确定</el-button>\n    </el-dialog>\n  </panel>\n</template>\n\n<script>\nimport ArticleCategoryService from '@/api/categories'\n\nexport default {\n  data() {\n    return {\n      fileList: [],\n      form: {\n        name: '',\n        cover: { path: '', name: '' }\n      },\n      dialogVisible: false,\n      dataList: [],\n      action: ''\n    }\n  },\n  created() {\n    ArticleCategoryService.fetchList()\n      .then(response => {\n        this.dataList = response\n      })\n      .catch(err => {\n        this.$message.error(err.message)\n      })\n  },\n  computed: {\n    dialogTitle() {\n      return this.action === 'create' ? '添加文章分类' : '编辑文章分类'\n    }\n  },\n  methods: {\n    onDialogOpen() {\n      this.$refs.input.focus()\n    },\n    openDialog() {\n      this.dialogVisible = true\n    },\n    closeDialog() {\n      this.dialogVisible = false\n      this.resetDialog()\n    },\n    resetDialog() {\n      this.form.name = ''\n      this.form.cover = { name: '', path: '' }\n      this.fileList = []\n    },\n    handleAdd() {\n      this.action = 'create'\n      this.openDialog()\n    },\n    async deleteOne(id, index) {\n      try {\n        await this.$confirm('此文章分类以经删除将无法恢复，是否删除?', '警告', {\n          type: 'warning'\n        })\n      } catch (error) {\n        return\n      }\n\n      ArticleCategoryService.deleteOneWithId(id)\n        .then(() => {\n          this.dataList.splice(index, 1)\n          this.$message.success('删除成功')\n        })\n        .catch(err => {\n          this.$message.error(err.message)\n        })\n    },\n    editOne(item) {\n      this.action = 'edit'\n      this.editingItem = item\n      _.merge(this.form, _.pick(item, _.keys(this.form)))\n\n      if (this.form.cover.path) {\n        this.fileList = [\n          { url: this.form.cover.path, name: this.form.cover.name }\n        ]\n      }\n\n      this.openDialog()\n    },\n    handleSubmit() {\n      const { name, cover } = this.form\n\n      if (!name) {\n        this.$message.error('请输入文章分类名称')\n        return\n      }\n      if (!cover.path) {\n        this.$message.error('请上传文章分类封面')\n        return\n      }\n\n      const payload = { name, cover }\n\n      const action =\n        this.action === 'create'\n          ? ArticleCategoryService.createOne(payload)\n          : ArticleCategoryService.updateOneWithId(this.editingItem.id, payload)\n\n      action\n        .then(response => {\n          if (this.action === 'create') {\n            this.dataList.unshift(response)\n          } else {\n            _.assign(this.editingItem, payload)\n          }\n\n          this.$message.success(`${this.dialogTitle}成功`)\n          this.closeDialog()\n        })\n        .catch(err => {\n          this.closeDialog()\n          this.$message.error(err.message)\n        })\n    }\n  }\n}\n</script>\n\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./List.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./List.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./List.vue?vue&type=template&id=aebc8170&\"\nimport script from \"./List.vue?vue&type=script&lang=js&\"\nexport * from \"./List.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}