(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c671b68"],{"12f8":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[a("el-tabs",{on:{"tab-click":e.toggleTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"list",label:"标签列表"}},[a("el-table",{attrs:{data:e.dataList,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"名称"}}),a("el-table-column",{attrs:{label:"封面"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("el-image",{staticStyle:{height:"60px"},attrs:{src:t.cover.path,"preview-src-list":[t.cover.path],fit:"cover"}})]}}])}),a("el-table-column",{attrs:{prop:"articleCount",label:"文章数量"}}),a("el-table-column",{attrs:{prop:"articlePublishedCount",label:"已发布文章数量"}}),a("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(new Date(a.updatedAt).toLocaleTimeString()))]}}])}),a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(new Date(a.createdAt).toLocaleTimeString()))]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.editOne(n.id,n)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.deleteOne(n.id,r)}}},[e._v("删除")])]}}])})],1)],1),a("el-tab-pane",{attrs:{name:"action",label:e.tagAction}},[a("el-form",[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{ref:"input",model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"封面"}},[a("upload",{attrs:{"file-list":e.fileList},on:{remove:function(t){e.form.cover={path:"",name:""}},success:function(t){return Object.assign(e.form.cover,t)}}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确定")])],1)],1)],1)],1)],1)},r=[],i=(a("96cf"),a("3b8d")),s=(a("7f7f"),a("8020")),c={name:"Tag",data:function(){return{dataList:[],fileList:[],activeName:"list",action:"create",form:{name:"",cover:{path:"",name:""}}}},computed:{tagAction:function(){return"edit"===this.action?"编辑标签":"添加标签"}},watch:{activeName:function(){setTimeout(this.$refs.input.focus)}},created:function(){var e=this;s["a"].fetchList().then((function(t){e.dataList=t})).catch((function(t){return e.$message.error(t.message)}))},methods:{handleSubmit:function(){var e=this,t=this.form,a=t.name,n=t.cover;if(a)if(n.path){var r={name:a,cover:n},i="edit"===this.action?s["a"].updateOne(this.editingItem.id,r):s["a"].createOne(r);i.then((function(t){"edit"===e.action?(e.editingItem.name=a,e.$message.success("标签编辑成功")):(e.$message.success("标签添加成功"),e.dataList.unshift(t)),e.resetTab()})).catch((function(t){return e.$message.error(t.message)}))}else this.$message.warning("请上传图片");else this.$message.warning("请输入标签名称")},resetTab:function(){this.activeName="list",this.action="create",this.form.name="",this.form.cover={name:"",path:""},this.fileList=[]},toggleTab:function(e){"list"===e.name&&this.resetTab()},deleteOne:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t,a){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("此标签以经删除将无法恢复, 是否继续 ?","提示",{type:"warning"});case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e["catch"](0),e.abrupt("return");case 8:s["a"].deleteOne(t).then((function(){n.$message.success("删除成功"),n.dataList.splice(a,1)})).catch((function(e){return n.$message.error(e.message)}));case 9:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t,a){return e.apply(this,arguments)}return t}(),editOne:function(e,t){this.editingItem=t,this.activeName="action",this.action="edit",_.assign(this.form,_.pick(t,["name","cover"]));var a=this.form.cover,n=a.path,r=a.name;n&&(this.fileList=[{url:n,name:r}])}}},o=c,l=a("2877"),u=Object(l["a"])(o,n,r,!1,null,null,null);t["default"]=u.exports},8020:function(e,t,a){"use strict";var n=a("0c6d");t["a"]={createOne:function(e){return n["a"].post("/tags",e)},fetchList:function(e){return n["a"].get("/tags",{params:e})},deleteOne:function(e){return n["a"].delete("/tags/".concat(e))},updateOne:function(e,t){return n["a"].patch("/tags/".concat(e),t)}}}}]);
//# sourceMappingURL=chunk-7c671b68.92859cc9.js.map